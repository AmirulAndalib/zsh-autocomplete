#!/bin/zsh
local 0=${(%):-%N}

$0() {
  local 0=${(%):-%N}
  typeset -gH curcontext=${WIDGET}:::

  local +h -a comppostfuncs=( "$comppostfuncs[@]" $0.post )
  unset 'compstate[old_list]'
  _main_complete _autocomplete.history_lines
  (( compstate[nmatches] > 0 ))

  unset curcontext
}

$0.post() {
  compstate[insert]='menu:0'
  compstate[list]='list force'
}

$0 "$@"
